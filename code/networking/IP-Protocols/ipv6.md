# IPv6 (Internet Protocol version 6) ğŸŒ

> **The next generation Internet Protocol**

## IPv6 Header

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         IPv6 Header (40 bytes fixed)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚    0                   1                   2                   3            â”‚
â”‚    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1         â”‚
â”‚   â”œâ”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¼â”€â”¤         â”‚
â”‚   â”‚Versionâ”‚ Traffic Class â”‚              Flow Label               â”‚  0-3   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚      Payload Length   â”‚   Next Header   â”‚     Hop Limit       â”‚  4-7   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                                                               â”‚        â”‚
â”‚   â”‚                      Source Address                           â”‚  8-23  â”‚
â”‚   â”‚                        (128 bits)                             â”‚        â”‚
â”‚   â”‚                                                               â”‚        â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                                                               â”‚        â”‚
â”‚   â”‚                    Destination Address                        â”‚ 24-39  â”‚
â”‚   â”‚                        (128 bits)                             â”‚        â”‚
â”‚   â”‚                                                               â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â”‚  Simplified compared to IPv4:                                              â”‚
â”‚  â€¢ No checksum (relies on L2 and L4)                                       â”‚
â”‚  â€¢ No fragmentation fields (source only)                                   â”‚
â”‚  â€¢ Fixed 40-byte header                                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Header Fields

| Field | Size | Description |
|-------|------|-------------|
| Version | 4 bits | Always 6 |
| Traffic Class | 8 bits | QoS (like DSCP) |
| Flow Label | 20 bits | Flow identification |
| Payload Length | 16 bits | Length of data after header |
| Next Header | 8 bits | Type of next header (TCP=6, UDP=17) |
| Hop Limit | 8 bits | Same as TTL |
| Source Address | 128 bits | Sender's IPv6 address |
| Destination Address | 128 bits | Recipient's IPv6 address |

## Extension Headers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Extension Header Chain                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  IPv6    â”‚â”€â”€â”€â–ºâ”‚  Hop-by- â”‚â”€â”€â”€â–ºâ”‚ Routing  â”‚â”€â”€â”€â–ºâ”‚   TCP    â”‚             â”‚
â”‚  â”‚  Header  â”‚    â”‚   Hop    â”‚    â”‚  Header  â”‚    â”‚  Header  â”‚             â”‚
â”‚  â”‚ NH=0     â”‚    â”‚  NH=43   â”‚    â”‚  NH=6    â”‚    â”‚          â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â”‚  Extension Header Order (recommended):                                     â”‚
â”‚  1. Hop-by-Hop Options (0)                                                 â”‚
â”‚  2. Destination Options (60) - for first dest                              â”‚
â”‚  3. Routing Header (43)                                                    â”‚
â”‚  4. Fragment Header (44)                                                   â”‚
â”‚  5. Authentication Header (51)                                             â”‚
â”‚  6. ESP Header (50)                                                        â”‚
â”‚  7. Destination Options (60) - for final dest                              â”‚
â”‚  8. Upper Layer (TCP/UDP/ICMPv6)                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## IPv6 Address Format

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IPv6 Address Notation                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Full form:       2001:0db8:0000:0000:0000:0000:0000:0001                  â”‚
â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚                      Network (64)        Interface ID (64)                 â”‚
â”‚                                                                             â”‚
â”‚  Compression rules:                                                         â”‚
â”‚  1. Leading zeros in group can be omitted:                                 â”‚
â”‚     2001:db8:0:0:0:0:0:1                                                   â”‚
â”‚                                                                             â”‚
â”‚  2. One sequence of all-zero groups can be replaced with :::               â”‚
â”‚     2001:db8::1                                                            â”‚
â”‚                                                                             â”‚
â”‚  Examples:                                                                  â”‚
â”‚  â€¢ ::1              = 0:0:0:0:0:0:0:1 (loopback)                           â”‚
â”‚  â€¢ ::               = all zeros (unspecified)                              â”‚
â”‚  â€¢ fe80::1          = fe80:0:0:0:0:0:0:1 (link-local)                     â”‚
â”‚  â€¢ ::ffff:192.0.2.1 = IPv4-mapped IPv6                                    â”‚
â”‚                                                                             â”‚
â”‚  CIDR: 2001:db8::/32                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Address Types

### Unicast

| Type | Prefix | Scope |
|------|--------|-------|
| Global Unicast | 2000::/3 | Internet routable |
| Link-Local | fe80::/10 | Single link only |
| Unique Local (ULA) | fc00::/7 (fd00::/8 used) | Private, like RFC1918 |
| Loopback | ::1/128 | Local host |
| Unspecified | ::/128 | No address |

### Multicast

| Address | Scope | Purpose |
|---------|-------|---------|
| ff02::1 | Link-local | All nodes |
| ff02::2 | Link-local | All routers |
| ff02::5 | Link-local | OSPF routers |
| ff02::6 | Link-local | OSPF DR routers |
| ff02::1:ff00:0/104 | Link-local | Solicited-node multicast |

### Anycast

- Same address on multiple interfaces
- Packet goes to nearest one
- Used for DNS, CDN, load balancing

## Interface ID Generation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Interface ID Methods                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. EUI-64 from MAC address:                                               â”‚
â”‚     MAC:      00:1a:2b:3c:4d:5e                                            â”‚
â”‚     Split:    00:1a:2b | 3c:4d:5e                                          â”‚
â”‚     Insert:   00:1a:2b:ff:fe:3c:4d:5e                                      â”‚
â”‚     Flip U/L: 02:1a:2b:ff:fe:3c:4d:5e                                      â”‚
â”‚     Result:   ::021a:2bff:fe3c:4d5e                                        â”‚
â”‚                                                                             â”‚
â”‚  2. Privacy Extensions (RFC 4941):                                         â”‚
â”‚     Random interface ID, changes periodically                              â”‚
â”‚     Prevents tracking                                                       â”‚
â”‚                                                                             â”‚
â”‚  3. Stable Privacy Addresses (RFC 7217):                                   â”‚
â”‚     Hash of prefix + interface + secret                                    â”‚
â”‚     Stable per network, but not trackable                                  â”‚
â”‚                                                                             â”‚
â”‚  4. Manual configuration                                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Address Autoconfiguration

### SLAAC (Stateless Address Autoconfiguration)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SLAAC Process                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Host                                     Router                            â”‚
â”‚    â”‚                                        â”‚                               â”‚
â”‚    â”‚â”€â”€â”€â”€ Router Solicitation (RS) â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  (ff02::2)                   â”‚
â”‚    â”‚     (optional, can wait for RA)        â”‚                               â”‚
â”‚    â”‚                                        â”‚                               â”‚
â”‚    â”‚â—„â”€â”€â”€ Router Advertisement (RA) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (ff02::1)                   â”‚
â”‚    â”‚     Contains:                          â”‚                               â”‚
â”‚    â”‚     â€¢ Prefix (e.g., 2001:db8:1::/64)   â”‚                               â”‚
â”‚    â”‚     â€¢ Prefix lifetime                  â”‚                               â”‚
â”‚    â”‚     â€¢ Flags (M, O, A)                  â”‚                               â”‚
â”‚    â”‚     â€¢ Default gateway                  â”‚                               â”‚
â”‚    â”‚                                        â”‚                               â”‚
â”‚    â”‚  Host creates address:                 â”‚                               â”‚
â”‚    â”‚  Prefix + Interface ID                 â”‚                               â”‚
â”‚    â”‚  2001:db8:1:: + ::1234:5678:abcd:ef01  â”‚                               â”‚
â”‚    â”‚  = 2001:db8:1::1234:5678:abcd:ef01     â”‚                               â”‚
â”‚    â”‚                                        â”‚                               â”‚
â”‚    â”‚â”€â”€â”€â”€ DAD (Neighbor Solicitation) â”€â”€â”€â”€â”€â”€â–ºâ”‚  Check uniqueness            â”‚
â”‚    â”‚                                        â”‚                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DHCPv6

| Flag | Meaning |
|------|---------|
| M=1 | Use DHCPv6 for address |
| O=1 | Use DHCPv6 for other info (DNS) |
| A=1 | Autonomous - use SLAAC for address |

## Neighbor Discovery Protocol (NDP)

Replaces ARP, ICMP Router Discovery, ICMP Redirect

| Message | ICMPv6 Type | Purpose |
|---------|-------------|---------|
| Router Solicitation (RS) | 133 | Find routers |
| Router Advertisement (RA) | 134 | Router announces itself |
| Neighbor Solicitation (NS) | 135 | Find MAC (like ARP) |
| Neighbor Advertisement (NA) | 136 | Reply with MAC |
| Redirect | 137 | Better route available |

## Transition Mechanisms

| Mechanism | Description |
|-----------|-------------|
| Dual Stack | Both IPv4 and IPv6 |
| 6to4 | Automatic tunneling (deprecated) |
| Teredo | IPv6 over UDP/IPv4 |
| ISATAP | IPv6 over IPv4 (intra-site) |
| NAT64 | Translate IPv6 to IPv4 |
| DNS64 | Synthesize AAAA records |
| 464XLAT | CLAT + NAT64 (mobile) |

## Configuration Examples

### Linux

```bash
# Show IPv6 addresses
ip -6 addr show

# Add address
sudo ip -6 addr add 2001:db8::1/64 dev eth0

# Add default route
sudo ip -6 route add default via 2001:db8::ffff

# Enable IPv6 forwarding
sudo sysctl -w net.ipv6.conf.all.forwarding=1

# Disable IPv6
sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1
```

### Cisco

```cisco
! Enable IPv6 routing
ipv6 unicast-routing

! Configure interface
interface GigabitEthernet0/0
 ipv6 address 2001:db8:1::1/64
 ipv6 address fe80::1 link-local
 ipv6 enable

! Static route
ipv6 route 2001:db8:2::/64 2001:db8:1::2
```

---

*Previous: [â† IPv4](./ipv4.md) | Next: [TCP â†’](./tcp.md)*

