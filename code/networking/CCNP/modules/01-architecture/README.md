# Module 1: Architecture ğŸ—ï¸

> **15% of ENCOR Exam | Estimated Time: 25-35 hours**

## Module Overview

This module covers enterprise network design principles, high availability, and software-defined networking architectures that are foundational to CCNP.

---

## Table of Contents

1. [Enterprise Network Design](#1-enterprise-network-design)
2. [High Availability](#2-high-availability)
3. [SD-Access Architecture](#3-sd-access-architecture)
4. [SD-WAN Architecture](#4-sd-wan-architecture)
5. [QoS Architecture](#5-qos-architecture)

---

## 1. Enterprise Network Design

### Campus Design Models

```
Traditional Three-Tier:              Collapsed Core (Two-Tier):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Core     â”‚ (L3 Routing)         â”‚  Distribution/Core     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚  (Combined Layer)      â”‚
       â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚ Distributionâ”‚ (L3 + Policies)      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚           â”‚           â”‚
       â”‚                          â”Œâ”€â”€â”´â”€â”€â”     â”Œâ”€â”€â”´â”€â”€â”     â”Œâ”€â”€â”´â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                   â”‚Accessâ”‚    â”‚Accessâ”‚    â”‚Accessâ”‚
â”‚   Access    â”‚ (L2 + Users)      â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   
                                  Use when: <200 users per building
Use when: Large campus
```

### Spine-Leaf (Data Center)

```
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Spine â”‚     â”‚ Spine â”‚
                 â”‚   1   â”‚     â”‚   2   â”‚
                 â””â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                     â”‚â•²         â•±â”‚
                     â”‚ â•²       â•± â”‚
                     â”‚  â•²     â•±  â”‚
                     â”‚   â•²   â•±   â”‚
                     â”‚    â•² â•±    â”‚
                     â”‚    â•± â•²    â”‚
                     â”‚   â•±   â•²   â”‚
                     â”‚  â•±     â•²  â”‚
                     â”‚ â•±       â•² â”‚
                     â”‚â•±         â•²â”‚
                 â”Œâ”€â”€â”€â”´â”€â”€â”€â”     â”Œâ”€â”€â”€â”´â”€â”€â”€â”
                 â”‚ Leaf  â”‚     â”‚ Leaf  â”‚
                 â”‚   1   â”‚     â”‚   2   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
              â”‚   Servers   â”‚     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                                  â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Servers     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
- Consistent latency (2 hops max)
- Easy horizontal scaling
- Full bisectional bandwidth
```

### Design Principles

| Principle | Description |
|-----------|-------------|
| Hierarchy | Modular layers for scalability |
| Modularity | Functional blocks (campus, WAN, DC) |
| Resiliency | Redundant paths, FHRP |
| Flexibility | Support for change/growth |
| Security | Segmentation, zero trust |

---

## 2. High Availability

### HA Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 High Availability Stack                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Device Level:                                              â”‚
â”‚  â”œâ”€â”€ Redundant Supervisors (SSO, NSF)                      â”‚
â”‚  â”œâ”€â”€ Redundant Power Supplies                              â”‚
â”‚  â””â”€â”€ In-Service Software Upgrade (ISSU)                    â”‚
â”‚                                                             â”‚
â”‚  Network Level:                                             â”‚
â”‚  â”œâ”€â”€ Redundant Links (EtherChannel, ECMP)                  â”‚
â”‚  â”œâ”€â”€ Redundant Devices (VSS, StackWise)                    â”‚
â”‚  â””â”€â”€ First Hop Redundancy (HSRP, VRRP, GLBP)              â”‚
â”‚                                                             â”‚
â”‚  Protocol Level:                                            â”‚
â”‚  â”œâ”€â”€ Fast Convergence (BFD, OSPF tuning)                   â”‚
â”‚  â”œâ”€â”€ Graceful Restart                                      â”‚
â”‚  â””â”€â”€ Route Dampening                                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Stateful Switchover (SSO) & NSF

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  SSO (Stateful Switchover):                                â”‚
â”‚  â€¢ Active supervisor syncs state to standby                â”‚
â”‚  â€¢ Switchover in <1 second                                 â”‚
â”‚  â€¢ Control plane restarts, data plane continues            â”‚
â”‚                                                             â”‚
â”‚  NSF (Non-Stop Forwarding):                                â”‚
â”‚  â€¢ Continues forwarding during control plane restart       â”‚
â”‚  â€¢ Works with SSO                                          â”‚
â”‚  â€¢ Requires NSF-aware neighbors                            â”‚
â”‚                                                             â”‚
â”‚  Graceful Restart (NSF-aware protocols):                   â”‚
â”‚  â€¢ OSPF Graceful Restart (RFC 3623)                        â”‚
â”‚  â€¢ BGP Graceful Restart (RFC 4724)                         â”‚
â”‚  â€¢ Neighbors hold routes during restart                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### BFD (Bidirectional Forwarding Detection)

```
BFD provides sub-second failure detection

Without BFD:                    With BFD:
OSPF Dead: 40 seconds          BFD: 50ms x 3 = 150ms
                               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   R1   â”‚â”€â”€â”€â”€â”€â”€â”‚   R2   â”‚     â”‚   R1   â”‚â”€â”€â”€â”€â”€â”€â”‚   R2   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                              â”‚
   â””â”€â”€ 40 sec to detect          â””â”€â”€ 150ms to detect
       link failure                  link failure
```

```cisco
! Enable BFD globally
Router(config)# bfd slow-timers 2000

! Configure BFD on interface
Router(config-if)# bfd interval 50 min_rx 50 multiplier 3

! Enable BFD for OSPF
Router(config-router)# bfd all-interfaces

! Enable BFD for BGP
Router(config-router)# neighbor 10.1.1.2 fall-over bfd
```

---

## 3. SD-Access Architecture ğŸ†•

### SD-Access Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SD-Access Architecture                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Management Plane:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Cisco DNA Center                          â”‚ â”‚
â”‚  â”‚         (Automation, Assurance, Policy)               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                  â”‚
â”‚  Control Plane:          â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Cisco ISE                                â”‚ â”‚
â”‚  â”‚         (Identity, Policy, SGT)                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                  â”‚
â”‚  Data Plane:             â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Fabric (VXLAN + LISP)                    â”‚ â”‚
â”‚  â”‚         Underlay + Overlay                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Fabric Components

| Component | Role | Function |
|-----------|------|----------|
| Fabric Border | Gateway | Connects to external networks |
| Fabric Control Plane | LISP Map Server | Host location database |
| Fabric Edge | Access | Endpoint connectivity |
| Intermediate Nodes | Underlay | IP transport |

### Underlay vs Overlay

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Underlay Network:                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  â€¢ Physical infrastructure                                  â”‚
â”‚  â€¢ IP routing (IS-IS recommended)                          â”‚
â”‚  â€¢ Provides reachability                                   â”‚
â”‚                                                             â”‚
â”‚  Overlay Network:                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚  â€¢ Virtual topology                                        â”‚
â”‚  â€¢ VXLAN encapsulation                                     â”‚
â”‚  â€¢ LISP for location/identity mapping                      â”‚
â”‚  â€¢ Carries user traffic                                    â”‚
â”‚                                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚              OVERLAY (VXLAN)                     â”‚   â”‚
â”‚     â”‚    Endpoint â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Endpoint       â”‚   â”‚
â”‚     â”‚       â”‚                              â”‚          â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚             â”‚                              â”‚               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     â”‚       â”‚    UNDERLAY (IP Routing)     â”‚          â”‚   â”‚
â”‚     â”‚    Edge â”€â”€â”€â”€ Spine â”€â”€â”€â”€ Spine â”€â”€â”€â”€ Edge         â”‚   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### LISP in SD-Access

```
LISP (Locator/ID Separation Protocol):

Traditional:  IP = Identity + Location (same address)
LISP:         EID (Endpoint ID) â‰  RLOC (Routing Locator)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚   Endpoint           Fabric Edge           Map Server      â”‚
â”‚   (EID)              (xTR)                 (MS/MR)         â”‚
â”‚   10.1.1.100         192.168.1.1          192.168.100.1   â”‚
â”‚      â”‚                   â”‚                     â”‚          â”‚
â”‚      â”‚  Traffic to       â”‚                     â”‚          â”‚
â”‚      â”‚  10.2.2.200       â”‚                     â”‚          â”‚
â”‚      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚          â”‚
â”‚      â”‚                   â”‚                     â”‚          â”‚
â”‚      â”‚                   â”‚  Map-Request        â”‚          â”‚
â”‚      â”‚                   â”‚  "Where is          â”‚          â”‚
â”‚      â”‚                   â”‚   10.2.2.200?"      â”‚          â”‚
â”‚      â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚          â”‚
â”‚      â”‚                   â”‚                     â”‚          â”‚
â”‚      â”‚                   â”‚  Map-Reply          â”‚          â”‚
â”‚      â”‚                   â”‚  "RLOC: 192.168.2.1"â”‚          â”‚
â”‚      â”‚                   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
â”‚      â”‚                   â”‚                     â”‚          â”‚
â”‚      â”‚                   â”‚  VXLAN encap to     â”‚          â”‚
â”‚      â”‚                   â”‚  192.168.2.1        â”‚          â”‚
â”‚      â”‚                   â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¶ â”‚          â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. SD-WAN Architecture ğŸ†•

### SD-WAN Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cisco SD-WAN Architecture                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     vManage                          â”‚   â”‚
â”‚  â”‚              (Management Plane)                      â”‚   â”‚
â”‚  â”‚       Configuration, Monitoring, Policies           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     vSmart                           â”‚   â”‚
â”‚  â”‚               (Control Plane)                        â”‚   â”‚
â”‚  â”‚         OMP Routes, Policies, Keys                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     vBond                            â”‚   â”‚
â”‚  â”‚              (Orchestration)                         â”‚   â”‚
â”‚  â”‚         Initial auth, controller discovery          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                 vEdge / cEdge                        â”‚   â”‚
â”‚  â”‚                (Data Plane)                          â”‚   â”‚
â”‚  â”‚           Site routers, IPsec tunnels               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SD-WAN vs Traditional WAN

| Feature | Traditional | SD-WAN |
|---------|-------------|--------|
| Provisioning | Manual CLI | Zero-touch |
| Transport | MPLS only | Any (MPLS, Internet, LTE) |
| Security | External firewall | Built-in |
| App Routing | Static | Application-aware |
| Visibility | Limited | End-to-end analytics |
| Cost | High (MPLS) | Lower (hybrid) |

### OMP (Overlay Management Protocol)

```
OMP: BGP-like protocol for SD-WAN overlay

Runs between:
- vEdge/cEdge â†â†’ vSmart (control connections)

Distributes:
- Routes (OMP routes, not BGP/OSPF directly)
- TLOC (Transport Location) - tunnel endpoints
- Service routes
- Policies

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  vEdge-1 â”€â”€â”€â”€â”€â”€ vSmart â”€â”€â”€â”€â”€â”€ vEdge-2                      â”‚
â”‚     â”‚            â”‚ â”‚            â”‚                           â”‚
â”‚     â”‚    OMP     â”‚ â”‚    OMP     â”‚                          â”‚
â”‚     â”‚  (DTLS)    â”‚ â”‚  (DTLS)    â”‚                          â”‚
â”‚     â”‚            â”‚ â”‚            â”‚                          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                  â”‚ â”‚                                        â”‚
â”‚           OMP Route Table                                   â”‚
â”‚           Stored on vSmart                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. QoS Architecture

### QoS Models

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      QoS Models                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Best Effort:                                               â”‚
â”‚  â€¢ No QoS, all traffic equal                               â”‚
â”‚  â€¢ FIFO queuing                                            â”‚
â”‚                                                             â”‚
â”‚  IntServ (Integrated Services):                            â”‚
â”‚  â€¢ Per-flow reservations                                   â”‚
â”‚  â€¢ RSVP signaling                                          â”‚
â”‚  â€¢ Not scalable for large networks                         â”‚
â”‚                                                             â”‚
â”‚  DiffServ (Differentiated Services): â† Used in Enterprise â”‚
â”‚  â€¢ Per-hop behaviors (PHB)                                 â”‚
â”‚  â€¢ DSCP marking                                            â”‚
â”‚  â€¢ Scalable, class-based                                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DSCP & PHB Classes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DSCP Values                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  PHB         â”‚ DSCP â”‚ Binary    â”‚ Traffic Type             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  EF          â”‚ 46   â”‚ 101110    â”‚ Voice (low latency)      â”‚
â”‚  AF41        â”‚ 34   â”‚ 100010    â”‚ Video conferencing       â”‚
â”‚  AF31        â”‚ 26   â”‚ 011010    â”‚ Streaming video          â”‚
â”‚  AF21        â”‚ 18   â”‚ 010010    â”‚ Transactional data       â”‚
â”‚  AF11        â”‚ 10   â”‚ 001010    â”‚ Bulk data                â”‚
â”‚  CS6         â”‚ 48   â”‚ 110000    â”‚ Network control          â”‚
â”‚  CS3         â”‚ 24   â”‚ 011000    â”‚ Signaling                â”‚
â”‚  DF (BE)     â”‚ 0    â”‚ 000000    â”‚ Best effort              â”‚
â”‚                                                             â”‚
â”‚  AF = Assured Forwarding                                    â”‚
â”‚  EF = Expedited Forwarding                                  â”‚
â”‚  CS = Class Selector                                        â”‚
â”‚  DF = Default Forwarding                                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### QoS Policy Configuration (MQC)

```cisco
! Step 1: Class-map (classify traffic)
class-map match-any VOICE
 match dscp ef
 match protocol rtp
class-map match-any VIDEO
 match dscp af41
class-map match-any CRITICAL
 match dscp af31

! Step 2: Policy-map (define actions)
policy-map WAN-QOS
 class VOICE
  priority percent 20
  set dscp ef
 class VIDEO
  bandwidth percent 30
  set dscp af41
 class CRITICAL
  bandwidth percent 20
  set dscp af31
 class class-default
  bandwidth percent 30
  fair-queue

! Step 3: Apply to interface
interface GigabitEthernet0/0
 service-policy output WAN-QOS
```

### Queuing Mechanisms

| Mechanism | Description | Use Case |
|-----------|-------------|----------|
| FIFO | First In First Out | Default, no QoS |
| PQ | Priority Queue | Voice (strict priority) |
| WFQ | Weighted Fair Queue | Fair sharing |
| CBWFQ | Class-Based WFQ | Bandwidth guarantees |
| LLQ | Low Latency Queue | Voice + other classes |

---

## ğŸ“ Module 1 Exercises

### Exercise 1.1: Design Review
Given a 5000-user campus with:
- 3 buildings
- Data center on-site
- WAN to 10 remote offices

Design the network architecture (draw topology).

### Exercise 1.2: BFD Configuration
Configure BFD between two OSPF routers with:
- 100ms detection time
- Apply to all OSPF interfaces

### Exercise 1.3: QoS Policy
Create a QoS policy that:
- Prioritizes voice (20%)
- Allocates video (30%)
- Provides bandwidth for business apps (25%)
- Default for rest

---

*Next Module: [Virtualization â†’](../02-virtualization/README.md)*

