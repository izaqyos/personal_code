# GSM (2G) ğŸ“

> **Global System for Mobile Communications**

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GSM Network Architecture                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Mobile Station (MS)                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚   ME     â”‚â”€â”€â”€â”€â”‚   SIM    â”‚  Mobile Equipment + Subscriber Identity     â”‚
â”‚  â”‚ (phone)  â”‚    â”‚  card    â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚ Um (Air Interface)                                                  â”‚
â”‚       â–¼                                                                     â”‚
â”‚  Base Station Subsystem (BSS)                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚   BTS    â”‚â”€â”€â”€â”€â”‚   BSC    â”‚  Base Transceiver Station + Controller      â”‚
â”‚  â”‚ (tower)  â”‚    â”‚          â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                       â”‚ A Interface                                         â”‚
â”‚                       â–¼                                                     â”‚
â”‚  Network Switching Subsystem (NSS)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚   MSC    â”‚â”€â”€â”€â”€â”‚   HLR    â”‚â”€â”€â”€â”€â”‚   VLR    â”‚                              â”‚
â”‚  â”‚ (switch) â”‚    â”‚ (home DB)â”‚    â”‚(visitor) â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚       â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚   GMSC   â”‚â”€â”€â”€â”€â”‚   PSTN   â”‚  Gateway to public network                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Components

| Component | Function |
|-----------|----------|
| **MS** | Mobile Station (phone + SIM) |
| **BTS** | Base Transceiver Station (radio tower) |
| **BSC** | Base Station Controller (manages BTSes) |
| **MSC** | Mobile Switching Center (call routing) |
| **HLR** | Home Location Register (permanent subscriber DB) |
| **VLR** | Visitor Location Register (temporary local DB) |
| **AuC** | Authentication Center (security keys) |
| **EIR** | Equipment Identity Register (IMEI blacklist) |

## GSM Protocols

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GSM Protocol Stack                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Layer 3:  CM (Call Management), MM (Mobility Management), RR (Radio)      â”‚
â”‚  Layer 2:  LAPDm (Link Access Procedure on Dm channel)                     â”‚
â”‚  Layer 1:  Physical layer (TDMA/FDMA)                                      â”‚
â”‚                                                                             â”‚
â”‚  Air Interface: Um                                                         â”‚
â”‚  â”œâ”€ FDMA: 200 kHz channels                                                 â”‚
â”‚  â”œâ”€ TDMA: 8 time slots per channel                                        â”‚
â”‚  â””â”€ GMSK modulation                                                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Frequency Bands

| Band | Uplink (MHz) | Downlink (MHz) | Region |
|------|--------------|----------------|--------|
| GSM 850 | 824-849 | 869-894 | Americas |
| GSM 900 | 890-915 | 935-960 | EU/APAC |
| DCS 1800 | 1710-1785 | 1805-1880 | EU/APAC |
| PCS 1900 | 1850-1910 | 1930-1990 | Americas |

## Call Flow

```
MS                BTS/BSC              MSC               HLR
â”‚                    â”‚                   â”‚                 â”‚
â”‚â”€â”€â”€ Channel Req â”€â”€â”€â–ºâ”‚                   â”‚                 â”‚
â”‚â—„â”€â”€ Channel Grant â”€â”€â”‚                   â”‚                 â”‚
â”‚                    â”‚                   â”‚                 â”‚
â”‚â”€â”€â”€ SABM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚                 â”‚
â”‚â—„â”€â”€ UA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                 â”‚
â”‚                    â”‚                   â”‚                 â”‚
â”‚â”€â”€â”€ CM Service Reqâ”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚                    â”‚                   â”‚â”€â”€â”€â”€ MAP Auth â”€â”€â–ºâ”‚
â”‚                    â”‚                   â”‚â—„â”€â”€â”€ Auth Resp â”€â”€â”‚
â”‚â—„â”€â”€ Auth Request â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚â”€â”€â”€ Auth Response â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚                    â”‚                   â”‚                 â”‚
â”‚â”€â”€â”€ Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚â—„â”€â”€ Call Proceedingâ”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚â—„â”€â”€ Alerting â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚â—„â”€â”€ Connect â”€â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚                    â”‚                   â”‚                 â”‚
â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Voice Call â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
```

## Security

| Algorithm | Purpose |
|-----------|---------|
| A3 | Authentication (challenge-response) |
| A5/1 | Encryption (original, broken) |
| A5/2 | Encryption (export, very weak) |
| A5/3 | Encryption (KASUMI, stronger) |
| A8 | Key generation |

### Authentication

```
AuC generates:        Ki (permanent key on SIM & AuC)
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
RAND (random) â”€â”€â”€â”€â–ºâ”‚     A3       â”‚â”€â”€â”€â”€â–º SRES (signed response)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
RAND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚     A8       â”‚â”€â”€â”€â”€â–º Kc (session key)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Next: [GPRS/EDGE â†’](./gprs.md)*

